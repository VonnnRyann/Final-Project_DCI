{"ast":null,"code":"var _jsxFileName = \"/home/user/Desktop/final-project-w2m/Wave2Me-DCI-FinalProject/client/src/components/Rating/RatingStars.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useRef, useEffect, useContext } from 'react';\nimport MyContext from '../../context/MyContext';\nimport Star from './Star';\nimport './Rating.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst RatingStars = () => {\n  _s();\n\n  const {\n    payload\n  } = useContext(MyContext);\n  const [gradeIndex, setGradeIndex] = useState();\n  const [comments, setComments] = useState([]);\n  const [seeMore, setSeeMore] = useState(false);\n  const inputRef = useRef();\n  const commentsRef = useRef();\n  const GRADES = ['Poor', 'Fair', 'Good', 'Very good', 'Excellent'];\n  const activeStar = {\n    fill: 'yellow'\n  };\n\n  const changeGradeIndex = index => {\n    setGradeIndex(index);\n  };\n\n  const displayInput = e => {\n    if (inputRef.current) {\n      inputRef.current.style.visibility = 'visible';\n      inputRef.current.style.width = '50vw';\n      inputRef.current.focus();\n      e.target.style.display = 'none';\n    }\n  };\n\n  const sendRating = e => {\n    fetch('https://wave2me.herokuapp.com/rating', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        name: payload.name,\n        rating: GRADES[gradeIndex - 1],\n        value: gradeIndex,\n        comment: e.target.previousSibling.value\n      })\n    }).then(res => res.json()).then(comment => {\n      setComments([comment.comment, ...comments]);\n      e.target.parentElement.style.display = 'none';\n    }).catch(err => console.log('ratings create error:', err));\n  };\n\n  const setCommentsSectionSize = size => {\n    commentsRef.current.style.height = size;\n    setSeeMore(!seeMore);\n  };\n\n  const createCommentStars = value => {\n    const arr = new Array(value);\n    arr.fill('o');\n    return arr;\n  };\n\n  useEffect(() => {\n    fetch('https://wave2me.herokuapp.com/rating').then(res => res.json()).then(data => {\n      setGradeIndex(data.average);\n      setComments(data.ratings.reverse());\n    }).catch(err => console.log('ratings fetch error:', err));\n  }, []);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"stars-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      className: \"result\",\n      children: GRADES[gradeIndex - 1] ? GRADES[gradeIndex - 1] : 'Thank You for rating our page'\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"stars\",\n      children: GRADES.map((grade, index) => /*#__PURE__*/_jsxDEV(Star, {\n        index: index,\n        changeGradeIndex: changeGradeIndex,\n        style: gradeIndex > index ? activeStar : {}\n      }, grade, false, {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 26\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"add-comment\",\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: displayInput,\n        children: \"Add Comment\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n        ref: inputRef,\n        placeholder: \"Put comment here\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: sendRating,\n        children: \"Send\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"section\", {\n      className: \"comment-section\",\n      ref: commentsRef,\n      children: comments.map((rating, i) => /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"comments\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"limitName\",\n            children: rating.name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 95,\n            columnNumber: 53\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"italic\",\n            children: rating.rating\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 96,\n            columnNumber: 53\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            children: createCommentStars(rating.value).map((item, j) => /*#__PURE__*/_jsxDEV(\"i\", {\n              className: \"fa fa-star-o comment-star\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 97,\n              columnNumber: 108\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 97,\n            columnNumber: 53\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            children: rating.comment\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 98,\n            columnNumber: 53\n          }, this)]\n        }, 'comm_' + i, true, {\n          fileName: _jsxFileName,\n          lineNumber: 94,\n          columnNumber: 49\n        }, this)\n      }, void 0, false))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 13\n    }, this), !seeMore ? /*#__PURE__*/_jsxDEV(\"button\", {\n      className: \"see-more\",\n      onClick: () => setCommentsSectionSize(`${commentsRef.current.scrollHeight}px`),\n      children: 'see all comments >>'\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 13\n    }, this) : /*#__PURE__*/_jsxDEV(\"button\", {\n      className: \"see-less\",\n      onClick: () => setCommentsSectionSize(`40vh`),\n      children: 'see less comments <<'\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 14\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 70,\n    columnNumber: 9\n  }, this);\n};\n\n_s(RatingStars, \"eNoqvC3rWj1p9nywSjz4Gthubxk=\");\n\n_c = RatingStars;\nexport default RatingStars;\n\nvar _c;\n\n$RefreshReg$(_c, \"RatingStars\");","map":{"version":3,"names":["React","useState","useRef","useEffect","useContext","MyContext","Star","RatingStars","payload","gradeIndex","setGradeIndex","comments","setComments","seeMore","setSeeMore","inputRef","commentsRef","GRADES","activeStar","fill","changeGradeIndex","index","displayInput","e","current","style","visibility","width","focus","target","display","sendRating","fetch","method","headers","body","JSON","stringify","name","rating","value","comment","previousSibling","then","res","json","parentElement","catch","err","console","log","setCommentsSectionSize","size","height","createCommentStars","arr","Array","data","average","ratings","reverse","map","grade","i","item","j","scrollHeight"],"sources":["/home/user/Desktop/final-project-w2m/Wave2Me-DCI-FinalProject/client/src/components/Rating/RatingStars.js"],"sourcesContent":["import React, { useState, useRef, useEffect, useContext } from 'react';\nimport MyContext from '../../context/MyContext';\nimport Star from './Star';\nimport './Rating.css'\n\nconst RatingStars = () => {\n\n    const {payload} = useContext(MyContext);\n\n    const [gradeIndex, setGradeIndex] = useState();\n    const [comments, setComments] = useState([]);\n    const [seeMore, setSeeMore] = useState(false);\n    const inputRef = useRef();\n    const commentsRef = useRef();\n    const GRADES = ['Poor', 'Fair', 'Good', 'Very good', 'Excellent'];\n    const activeStar = {\n        fill: 'yellow'\n    };\n\n    const changeGradeIndex = ( index ) => {\n        setGradeIndex(index);\n    }\n\n    const displayInput = (e) => {\n        if(inputRef.current) {\n            inputRef.current.style.visibility='visible';\n            inputRef.current.style.width='50vw';\n            inputRef.current.focus();\n            e.target.style.display='none';\n        }\n    }\n\n    const sendRating = (e) => {\n        fetch('https://wave2me.herokuapp.com/rating', {\n            method:'POST',\n            headers: {'Content-Type':'application/json'},\n            body: JSON.stringify({\n                name: payload.name, \n                rating: GRADES[gradeIndex-1], \n                value: gradeIndex,\n                comment: e.target.previousSibling.value\n            })\n        })\n            .then(res=>res.json())\n            .then(comment=>{setComments([comment.comment,...comments]);e.target.parentElement.style.display='none'})\n            .catch(err=>console.log('ratings create error:',err))\n    }\n\n    const setCommentsSectionSize = (size) => {\n        commentsRef.current.style.height=size;\n        setSeeMore(!seeMore);\n    }\n\n    const createCommentStars = (value) => {\n        const arr = new Array(value);\n        arr.fill('o');\n        return arr;\n    }\n\n    useEffect(()=>{\n\n        fetch('https://wave2me.herokuapp.com/rating')\n            .then(res=>res.json())\n            .then(data=>{setGradeIndex(data.average); setComments(data.ratings.reverse());})\n            .catch(err=>console.log('ratings fetch error:',err));\n\n    },[]);\n\n    return (\n        <div className=\"stars-container\">\n            <h1 className=\"result\">{ GRADES[gradeIndex-1] ? GRADES[gradeIndex-1] : 'Thank You for rating our page'}</h1>\n            <div className=\"stars\">\n                {\n                    GRADES.map((grade, index) => (\n                      \n                         <Star \n                            index={index} \n                            key={grade} \n                            changeGradeIndex={changeGradeIndex}\n                            style={ gradeIndex > index ? activeStar : {}}\n                        />\n                    ))\n                   \n                }\n            </div>\n            <div className='add-comment'> \n                <button onClick={displayInput}>Add Comment</button>\n                <textarea ref={inputRef} placeholder=\"Put comment here\" />\n                <button onClick={sendRating}>Send</button>\n            </div>\n            \n            <section className='comment-section' ref={commentsRef}>\n                {comments.map((rating,i)=><>\n                                                <div key={'comm_'+i} className='comments'>\n                                                    <span className='limitName'>{rating.name}</span>\n                                                    <span className='italic'>{rating.rating}</span>\n                                                    <span>{ createCommentStars(rating.value).map((item,j)=><i className=\"fa fa-star-o comment-star\" />) }</span>\n                                                    <span>{rating.comment}</span>\n                                                </div>\n                                            </>)}\n            </section>\n            {!seeMore?\n            <button className='see-more' onClick={()=>setCommentsSectionSize(`${commentsRef.current.scrollHeight}px`)}>{'see all comments >>'}</button>\n            :<button className='see-less' onClick={()=>setCommentsSectionSize(`40vh`)}>{'see less comments <<'}</button>}\n\n        </div>\n    );\n}\n\nexport default RatingStars;"],"mappings":"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"},"metadata":{},"sourceType":"module"}