{"ast":null,"code":"import _toConsumableArray from\"/home/user/Desktop/final-project-w2m/Wave2Me-DCI-FinalProject/client/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"/home/user/Desktop/final-project-w2m/Wave2Me-DCI-FinalProject/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useRef,useEffect,useContext}from'react';import MyContext from'../../context/MyContext';import Star from'./Star';import'./Rating.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var RatingStars=function RatingStars(){var _useContext=useContext(MyContext),payload=_useContext.payload;var _useState=useState(),_useState2=_slicedToArray(_useState,2),gradeIndex=_useState2[0],setGradeIndex=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),comments=_useState4[0],setComments=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),seeMore=_useState6[0],setSeeMore=_useState6[1];var inputRef=useRef();var commentsRef=useRef();var GRADES=['Poor','Fair','Good','Very good','Excellent'];var activeStar={fill:'yellow'};var changeGradeIndex=function changeGradeIndex(index){setGradeIndex(index);};var displayInput=function displayInput(e){if(inputRef.current){inputRef.current.style.visibility='visible';inputRef.current.style.width='50vw';inputRef.current.focus();e.target.style.display='none';}};var sendRating=function sendRating(e){fetch('https://wave2me.herokuapp.com/rating',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({name:payload.name,rating:GRADES[gradeIndex-1],value:gradeIndex,comment:e.target.previousSibling.value})}).then(function(res){return res.json();}).then(function(comment){setComments([comment.comment].concat(_toConsumableArray(comments)));e.target.parentElement.style.display='none';}).catch(function(err){return console.log('ratings create error:',err);});};var setCommentsSectionSize=function setCommentsSectionSize(size){commentsRef.current.style.height=size;setSeeMore(!seeMore);};var createCommentStars=function createCommentStars(value){var arr=new Array(value);arr.fill('o');return arr;};useEffect(function(){fetch('https://wave2me.herokuapp.com/rating').then(function(res){return res.json();}).then(function(data){setGradeIndex(data.average);setComments(data.ratings.reverse());}).catch(function(err){return console.log('ratings fetch error:',err);});},[]);return/*#__PURE__*/_jsxs(\"div\",{className:\"stars-container\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"result\",children:GRADES[gradeIndex-1]?GRADES[gradeIndex-1]:'Thank You for rating our page'}),/*#__PURE__*/_jsx(\"div\",{className:\"stars\",children:GRADES.map(function(grade,index){return/*#__PURE__*/_jsx(Star,{index:index,changeGradeIndex:changeGradeIndex,style:gradeIndex>index?activeStar:{}},grade);})}),/*#__PURE__*/_jsxs(\"div\",{className:\"add-comment\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:displayInput,children:\"Add Comment\"}),/*#__PURE__*/_jsx(\"textarea\",{ref:inputRef,placeholder:\"Put comment here\"}),/*#__PURE__*/_jsx(\"button\",{onClick:sendRating,children:\"Send\"})]}),/*#__PURE__*/_jsx(\"section\",{className:\"comment-section\",ref:commentsRef,children:comments.map(function(rating,i){return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"comments\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"limitName\",children:rating.name}),/*#__PURE__*/_jsx(\"span\",{className:\"italic\",children:rating.rating}),/*#__PURE__*/_jsx(\"span\",{children:createCommentStars(rating.value).map(function(item,j){return/*#__PURE__*/_jsx(\"i\",{className:\"fa fa-star-o comment-star\"});})}),/*#__PURE__*/_jsx(\"span\",{children:rating.comment})]},'comm_'+i)});})}),!seeMore?/*#__PURE__*/_jsx(\"button\",{className:\"see-more\",onClick:function onClick(){return setCommentsSectionSize(\"\".concat(commentsRef.current.scrollHeight,\"px\"));},children:'see all comments >>'}):/*#__PURE__*/_jsx(\"button\",{className:\"see-less\",onClick:function onClick(){return setCommentsSectionSize(\"40vh\");},children:'see less comments <<'})]});};export default RatingStars;","map":{"version":3,"names":["React","useState","useRef","useEffect","useContext","MyContext","Star","RatingStars","payload","gradeIndex","setGradeIndex","comments","setComments","seeMore","setSeeMore","inputRef","commentsRef","GRADES","activeStar","fill","changeGradeIndex","index","displayInput","e","current","style","visibility","width","focus","target","display","sendRating","fetch","method","headers","body","JSON","stringify","name","rating","value","comment","previousSibling","then","res","json","parentElement","catch","err","console","log","setCommentsSectionSize","size","height","createCommentStars","arr","Array","data","average","ratings","reverse","map","grade","i","item","j","scrollHeight"],"sources":["/home/user/Desktop/final-project-w2m/Wave2Me-DCI-FinalProject/client/src/components/Rating/RatingStars.js"],"sourcesContent":["import React, { useState, useRef, useEffect, useContext } from 'react';\nimport MyContext from '../../context/MyContext';\nimport Star from './Star';\nimport './Rating.css'\n\nconst RatingStars = () => {\n\n    const {payload} = useContext(MyContext);\n\n    const [gradeIndex, setGradeIndex] = useState();\n    const [comments, setComments] = useState([]);\n    const [seeMore, setSeeMore] = useState(false);\n    const inputRef = useRef();\n    const commentsRef = useRef();\n    const GRADES = ['Poor', 'Fair', 'Good', 'Very good', 'Excellent'];\n    const activeStar = {\n        fill: 'yellow'\n    };\n\n    const changeGradeIndex = ( index ) => {\n        setGradeIndex(index);\n    }\n\n    const displayInput = (e) => {\n        if(inputRef.current) {\n            inputRef.current.style.visibility='visible';\n            inputRef.current.style.width='50vw';\n            inputRef.current.focus();\n            e.target.style.display='none';\n        }\n    }\n\n    const sendRating = (e) => {\n        fetch('https://wave2me.herokuapp.com/rating', {\n            method:'POST',\n            headers: {'Content-Type':'application/json'},\n            body: JSON.stringify({\n                name: payload.name, \n                rating: GRADES[gradeIndex-1], \n                value: gradeIndex,\n                comment: e.target.previousSibling.value\n            })\n        })\n            .then(res=>res.json())\n            .then(comment=>{setComments([comment.comment,...comments]);e.target.parentElement.style.display='none'})\n            .catch(err=>console.log('ratings create error:',err))\n    }\n\n    const setCommentsSectionSize = (size) => {\n        commentsRef.current.style.height=size;\n        setSeeMore(!seeMore);\n    }\n\n    const createCommentStars = (value) => {\n        const arr = new Array(value);\n        arr.fill('o');\n        return arr;\n    }\n\n    useEffect(()=>{\n\n        fetch('https://wave2me.herokuapp.com/rating')\n            .then(res=>res.json())\n            .then(data=>{setGradeIndex(data.average); setComments(data.ratings.reverse());})\n            .catch(err=>console.log('ratings fetch error:',err));\n\n    },[]);\n\n    return (\n        <div className=\"stars-container\">\n            <h1 className=\"result\">{ GRADES[gradeIndex-1] ? GRADES[gradeIndex-1] : 'Thank You for rating our page'}</h1>\n            <div className=\"stars\">\n                {\n                    GRADES.map((grade, index) => (\n                      \n                         <Star \n                            index={index} \n                            key={grade} \n                            changeGradeIndex={changeGradeIndex}\n                            style={ gradeIndex > index ? activeStar : {}}\n                        />\n                    ))\n                   \n                }\n            </div>\n            <div className='add-comment'> \n                <button onClick={displayInput}>Add Comment</button>\n                <textarea ref={inputRef} placeholder=\"Put comment here\" />\n                <button onClick={sendRating}>Send</button>\n            </div>\n            \n            <section className='comment-section' ref={commentsRef}>\n                {comments.map((rating,i)=><>\n                                                <div key={'comm_'+i} className='comments'>\n                                                    <span className='limitName'>{rating.name}</span>\n                                                    <span className='italic'>{rating.rating}</span>\n                                                    <span>{ createCommentStars(rating.value).map((item,j)=><i className=\"fa fa-star-o comment-star\" />) }</span>\n                                                    <span>{rating.comment}</span>\n                                                </div>\n                                            </>)}\n            </section>\n            {!seeMore?\n            <button className='see-more' onClick={()=>setCommentsSectionSize(`${commentsRef.current.scrollHeight}px`)}>{'see all comments >>'}</button>\n            :<button className='see-less' onClick={()=>setCommentsSectionSize(`40vh`)}>{'see less comments <<'}</button>}\n\n        </div>\n    );\n}\n\nexport default RatingStars;"],"mappings":"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"},"metadata":{},"sourceType":"module"}